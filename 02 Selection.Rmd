---
title: "02 Selection"
author: '35762384'
date: "17/02/2021"
output: 
  html_document: 
    keep_md: yes
    code_folding: show  
---  
```{r, include=FALSE}
library(sf)
library(readxl)
library(dplyr)
library(plyr)
library(ggplot2)
library(afrihealthsites)
library(ggpubr)
library(afriadmin)
library(tmap)
library(forcats)
library(cowplot)
library(colorspace)
library(readr)
library(waffle)
library(sunburstR)
library(htmltools)
library(htmlwidgets)
library(rhealthsites)

# Install Malawi MFL
malawi_MFL = read_excel("~/malawi-health-facilities-1/MHFR_Facilities 1.xlsx")

# Convert to sf

## omit NA's
new_malawi_MFL = na.omit(malawi_MFL)

## transform geometry columns into numeric 
new_malawi_MFL = transform(new_malawi_MFL, LATITUDE = as.numeric(LATITUDE), 
                                           LONGITUDE = as.numeric(LONGITUDE))

## convert to sf object
malawi_facilities_MFL = st_as_sf(new_malawi_MFL, coords = c("LONGITUDE", "LATITUDE"), dim = "XY")

malawi_facilities_MFL = st_set_crs(malawi_facilities_MFL, 4326)

malawi_WHO <- afrihealthsites("malawi", datasource='who', plot=FALSE, returnclass='dataframe')
malawi_WHO = malawi_WHO[ , -10]

new_malawi_WHO = na.omit(malawi_WHO) ## omit NA

sf_malawi_WHO = st_as_sf(new_malawi_WHO, coords = c("Long", "Lat"), dim = "XY")
sf_malawi_WHO = st_set_crs(sf_malawi_WHO, 4326)
```  

#### Introduction  
The availability of health facility data, such as location, capacity and resources present, is an important factor needed for decision-making processes, especially in the ongoing COVID-19 pandemic. Examples of uses include planning of interventions, disease surveillance, information for insurance companies and health management information systems (HMIS) (WHO, 2018). It is also often used for research purposes, with many studies utilising facility data to determine accessibility to healthcare or travel times (Hulland et al., 2019). However, availability is often not the issue but the fact that there are multiple sources and the discrepancies between them (Makinde et al., 2018). It is common for different organisations, e.g. non-governmental organisations (NGOs), government departments and other non-profit organisations, to produce their own lists and a need to further investigate differences is noted in studies using this data (Hulland, 2020). The aim of this paper is to do address this point; to analyse and highlight the differences between sources of facility data using Malawi as a case study and mark areas for improvement in the quality of the data.

One source for Malawi is a list compiled by the Kenyan Wellcome Trust Research Programme (KWTRP) for 50 sub-Saharan African countries and was released in 2019 (Maina et al., 2019). It focused on public health facilities, those run by the government, faith-based organisations (FBOs) and NGOs and also removed facilities that only provide specialised care such as psychiatry. It’s availability as open-access data as well as the thorough cleaning and validation processes implemented, meant it is often cited in other studies (Falchetta et al., 2020) (Judson et al., 2020) (Dowhaniuk, 2021) (Wariri et al., 2021). Several sources of information for facilities were combined to produce one list and in the case of Malawi, personal communication with health related organisations, data from The Humanitarian Data Exchange (HDX) and The Christian Health Association of Malawi (CHAM) were used (Maina et al., 2019). An important note is that the years of when the information was acquired from these sources vary, with the most recent being 2017 and the personal communication being conducted in 2013. The list is now being hosted by the World Health Organisation (WHO) Global Malaria Programme with the aim to update (WHO, 2019). However, since the publication of this study, there have been no updates or changes. Therefore, there is a need to compare with other sources, especially as the age of this data might mean new developments are not captured which could affect the study’s popularity. 

A newer source is the Master Facility List (MFL) from and managed by the Malawi Ministry of Health (MOH, 2021). The WHO recommends that every country produces a MFL with the aim of it being the primary source and describes how to develop it in (WHO, 2019). It must be accessible, regularly updated and validated. Although many African countries have made steps towards formulating a MFL under these guidelines, issues of access and missing elements are often 
encountered, making its usage more difficult (South et al., 2021). With Malawi, the MFL is openly available.However, its validation methods are not made clear and information on the most recent update is only available when selecting a specific facility and is not part of the dataset that can be downloaded. Despite this, the fact that is maintained by the Ministry of Health and so has the potential to be incorporated into the health system and that it is a more recent source, it is worth investigating how this list compares to others. 

Other sources are mostly dependent on information contributed by volunteers, of which healthsites.io is a global project aiming to map every health facility running (Healthsites, 2021). It works with OpenStreetMap, which provides the baseline map as well as the methods to input data, and since its establishment in 2016 has recorded over 900,000 facilities. Anyone can contribute and effort has been put into validation processes, which includes a Location Validation Index, a score that reflects other users verifying that facility exists. The data is freely available and access to the most recent version can be gained through several formats such as an API. Other lists can also be incorporated into healthsites.io and there is a process outlined for the import of facility lists from national ministries of health. However, similarly with other lists, it struggles with completeness and it has been shown that less than 2% of healthsites.io data for sub-Saharan Africa contains attributes describing capacity (South et al., 2021). It seems that the quality or functionality of these lists is limited across all of these sources. 

Quality data is important but this is often neglected or not investigated. There are several issues that are prominent with facility data from sub-Saharan Africa. Lists are often missing key elements such as capacity, equipment and services they provide. Not only this, problems with missing coordinates can also occur, with the WHO-KWTRP data reporting 9 missing coordinates for Malawi (Maina et al., 2019). These issues are present but there is not much research highlighting this, especially when comparing between sources, but this is important for studies that go on to utilise these lists. The outbreak of COVID-19 brought a greater emphasis on the need for this. Several countries have allowed open access to their facility data, encouraging external research to aid the response to the pandemic and improvement of the data itself . For example, research investigating the ability of health facilities to increase capacity and the identification of people vulnerable due to various factors in Kenya were performed with open facility data (Barasa et al., 2020) (Macharia et al., 2020). Therefore, maintenance and quality control of facility lists are essential in providing accurate data and contributing to valid research. 

The aim for this paper is to provide a reproducible summary of facility data for Malawi, discuss differences that are relevant to potential stakeholders and make apparent areas for improvement. The following hypotheses have been developed to address this: 

1.	The same number of health facility locations are recorded for Malawi across healthsites.io, WHO-KWTRP and their MFL
2.	The health facility locations and proportion of facility types recorded in the Malawi MFL are similar to those being used in current global analyses
3.	Hospital locations stored in healthsites.io are currently not a good representation of those available from the Malawi MFL


##### Methods  
- Websites from where I downloaded  
- What was done to the data pre-analysis, e.g. removing NAs  
- Software used (packages?)  

##### Results  

##### Hypothesis 1  

The MFL contains more than 2 and 5 times as many facilities compared to the WHO-KWTRP and healthsites.io respectively. In total, there are 639 facilities recorded in the WHO-KWTRP data, 1427 in the MFL and 247 in healthsites.io (figure 1). These numbers have been derived after the removal of missing coordinates.  

```{r Number of facilities, echo=FALSE}
# Check healthsites from afrihealthsites
malawi_healthsites <- afrihealthsites("malawi", datasource='healthsites', plot=FALSE, returnclass='dataframe')

# See if its different from rhealthsites package
hs_set_api_key("d426d9b2b210263c3f6fe924161a3d9ac293a6fe")
malawi_rhs = hs_facilities(country = "Malawi") # has 247 facilities, matches website

# Compare the 2 
malawi_rhs_noSF = st_set_geometry(malawi_rhs, NULL)
malawi_healthsites_noSF = st_set_geometry(malawi_healthsites, NULL)
# using anti_join = Mostly different, only 15 are the same 


# Use rhealthsites

## table
Sources = c("MFL", "WHO-KWTRP", "healthsites.io")
Number = c(1427, 639, 247)
number_3sources = data.frame(Sources, Number)

# plot
plot_3sources = ggplot(number_3sources, aes(x=Sources, y=Number)) + geom_bar(stat = "identity", width = 0.7, fill="slategray") + labs(x = "Source of data", y = "Number of facilities") + theme_minimal() + expand_limits(y=c(0,1500)) + coord_flip()
plot_3sources
```  
  
##### Hypothesis 2  

With the WHO-KWTRP list often used in research, a comparison to the MFL is made here. Setting aside the classifications of unclassified and private in the MFL, both the MFL and WHO-KWTRP have similar numbers of classification types (figure 2). However, there is a difference in the amount of specificity. The WHO-KWTRP provides 5 categories for hospitals while the MFL only provides 3. In contrast, the MFL separates health posts and dispensaries while WHO-KWTRP combines these facilities. The private and unclassified groups not present in WHO-KWTRP only make up 0.5% of the number of facilities in the MFL. Much of the variation between these two sources is accounted for by the number of each type of facilities. Hospitals constitute 8.2% of the total in the MFL and 12.8% in WHO-KWTRP. Health centres form most of the facilities in the WHO-KWTRP list, 71.5%, while the closely related clinics only form 3.4%. In the MFL, there is more of an even spread of clinics and health centres, which constitute 36.4% and 40.9% respectively.  

```{r Types of facilities, echo=FALSE}
# MFL
# Re-order the facility types
malawi_MFL$TYPE = as.factor(malawi_MFL$TYPE)

malawi_MFL$TYPE = factor(malawi_MFL$TYPE, levels = c("Central Hospital", "District Hospital", "Hospital", "Health Centre", "Clinic", "Health Post", "Dispensary", "Private", "Unclassified"))

# Number of each type + ownership
facility_types_MFL = as.data.frame(table(malawi_MFL$TYPE, malawi_MFL$OWNERSHIP))

# Only showing government, private and CHAM ownership
facility_types_MFL$new_Var2 = revalue(facility_types_MFL$Var2, c("Aquaid Lifeline"="Other", "Non-Government"="Other", "Parastatal"="Other", "Mission/Faith-based (other than CHAM)"="Other"))
facility_types_MFL$new_Var2 = factor(facility_types_MFL$new_Var2, levels = c("Government", "Private", "Christian Health Association of Malawi (CHAM)", "Other"))

## bar plot of no. of facility types 
plot_facility_types_MFL = ggplot(facility_types_MFL, aes(x=Var1, y=Freq, fill=new_Var2)) + geom_bar(position = "stack", stat = "identity")

plot_facility_types_MFL = plot_facility_types_MFL + labs(x = "Facility types", y = "Frequency", fill="Ownership") + scale_fill_brewer(palette = "Set2") + coord_flip() + theme_minimal() + ggtitle("MFL") + theme(axis.title.y = element_blank(), legend.title = element_text(size = 8, face = "bold"), legend.text = element_text(size = 8), plot.title = element_text(face = "bold", hjust = 0), legend.position = "bottom")

# WHO
# Re order facility types and ownership 
malawi_WHO$`Facility type` = as.factor(malawi_WHO$`Facility type`)
malawi_WHO$`Facility type` = factor(malawi_WHO$`Facility type`, levels = c("Central Hospital", "District Hospital", "Mission Hospital", "Rural Hospital", "Community Hospital", "Health Centre", "Clinic", "Health Post/Dispensary"))

malawi_WHO$Ownership = as.factor(malawi_WHO$Ownership)
malawi_WHO$Ownership = factor(malawi_WHO$Ownership, levels = c("MoH", "FBO", "Local authority", "NGO"))

# No. of original facility types + ownership
facility_types_WHO = as.data.frame(table(malawi_WHO$`Facility type`, malawi_WHO$Ownership))

## bar plot of original facility types 
plot_facility_types_WHO = ggplot(facility_types_WHO, aes(x=Var1, y=Freq, fill=Var2)) + geom_bar(position = "stack", stat = "identity")
plot_facility_types_WHO = plot_facility_types_WHO + labs(x = "Facility types", y = "Frequency", fill="Ownership") + scale_fill_brewer(palette = "Set2") + coord_flip() + theme_minimal() + ggtitle("WHO") + theme(axis.title.y = element_blank(), legend.title = element_text(size = 8, face = "bold"), legend.text = element_text(size = 8), plot.title = element_text(face = "bold", hjust = 0), legend.position = "bottom") + expand_limits(y=c(0,600))

plot_facilities = align_plots(plot_facility_types_MFL, plot_facility_types_WHO, align = "v")
ggdraw(plot_facilities[[1]])
ggdraw(plot_facilities[[2]])
```  
  
Figure 3 shows the point locations of each facility from both sources and an interactive version can be viewed online. By viewing this map, it appears that the same central hospitals are recorded in both lists and majority of district hospitals, apart from 2, are also matching. Distribution of the 3 other hospital categories in WHO-KWTRP is similar to that of 'hospital' in the MFL (figure 3). However, it also confirms the MFL has a significant number of clinics that are not accounted for in the WHO-KWRTP list, which only reports a small number in the central and southern regions.  

```{r, include=FALSE}
malawi_admin1 = afriadmin("malawi", level = 1, plot = "sf")
malawi_admin2 = afriadmin("malawi",level=2, plot='sf')

new_malawi_WHO = na.omit(malawi_WHO) ## omit NA

sf_malawi_WHO = st_as_sf(new_malawi_WHO, coords = c("Long", "Lat"), dim = "XY")
sf_malawi_WHO = st_set_crs(sf_malawi_WHO, 4326)

tmap_mode("view")
```

```{r Maps, echo=FALSE, warning=FALSE, message=FALSE}

# Point locations - combined 
tmap_admin2 = tm_shape(st_geometry(malawi_admin2)) + tm_borders()

## subsetting WHO to get layers for each type of facility
## so distribution of each type can be compared
central_hosp_WHO = filter(sf_malawi_WHO, `Facility type` == "Central Hospital")
district_hosp_WHO = filter(sf_malawi_WHO, `Facility type` == "District Hospital")
mission_hosp_WHO = filter(sf_malawi_WHO, `Facility type` == "Mission Hospital")
rural_hosp_WHO = filter(sf_malawi_WHO, `Facility type` == "Rural Hospital")
community_hosp_WHO = filter(sf_malawi_WHO, `Facility type` == "Community Hospital")
health_centre_WHO = filter(sf_malawi_WHO, `Facility type` == "Health Centre")
clinic_WHO = filter(sf_malawi_WHO, `Facility type` == "Clinic")
post_disp_WHO = filter(sf_malawi_WHO, `Facility type` == "Health Post/Dispensary")

## map WHO
tmap_facilities_WHO = tmap_admin2 + tm_shape(central_hosp_WHO) + tm_dots(col = "yellow") + tm_shape(district_hosp_WHO) + tm_dots(col = "olivedrab3") + tm_shape(mission_hosp_WHO) + tm_dots(col = "yellowgreen") + tm_shape(rural_hosp_WHO) + tm_dots(col = "palegreen3") + tm_shape(community_hosp_WHO) + tm_dots(col = "mediumseagreen") + tm_shape(health_centre_WHO) + tm_dots(col = "lightseagreen") + tm_shape(clinic_WHO) + tm_dots(col = "skyblue3") + tm_shape(post_disp_WHO) + tm_dots(col = "slateblue3")+ tm_layout(frame = FALSE, asp = 2, title = "WHO", title.position = c("left", "top"))

## same with MFL
central_hosp_MFL = filter(malawi_facilities_MFL, TYPE == "Central Hospital")
district_hosp_MFL = filter(malawi_facilities_MFL, TYPE == "District Hospital")
hosp_MFL = filter(malawi_facilities_MFL, TYPE == "Hospital")
health_centre_MFL = filter(malawi_facilities_MFL, TYPE == "Health Centre")
clinic_MFL = filter(malawi_facilities_MFL, TYPE == "Clinic")
post_MFL = filter(malawi_facilities_MFL, TYPE == "Health Post")
dispensary_MFL = filter(malawi_facilities_MFL, TYPE == "Dispensary")
priv_MFL = filter(malawi_facilities_MFL, TYPE == "Private")
un_MFL = filter(malawi_facilities_MFL, TYPE == "Unclassified")

tmap_facilities_MFL = tmap_admin2 + tm_shape(central_hosp_MFL) + tm_dots(col = "yellow") + tm_shape(district_hosp_MFL) + tm_dots(col = "olivedrab3") + tm_shape(hosp_MFL) + tm_dots(col = "mediumseagreen") + tm_shape(health_centre_MFL) + tm_dots(col = "lightseagreen") + tm_shape(clinic_MFL) + tm_dots(col = "skyblue3") + tm_shape(post_MFL) + tm_dots(col = "slateblue1") + tm_shape(dispensary_MFL) + tm_dots(col = "orchid3") + tm_shape(priv_MFL) + tm_dots(col = "slategray") + tm_shape(un_MFL) + tm_dots(col = "slategray") + tm_layout(frame = FALSE, asp = 2, title = "MFL", title.position = c("left", "top"))

facilities = tmap_arrange(tmap_facilities_MFL, tmap_facilities_WHO, ncol = 2)
facilities
```  
  
**Talk about ownership here??**  

**Proportion that are Government or Faith-based owned**   
- 47.7% in MFL are Government owned  
- 15.4% in MFL are Faith-based owned (includes CHAM)  
- In WHO, 72.5% are Government owned  
- In WHO, 26.3% are Faith-based owned  

**Proportion that are privately owned in the MFL data**    
- 30.3% of facilities are privately owned (433/1427)  
- Top 3 types are clinics (356), dispensaries (45) and hospitals (16)  
```{r Private MFL, include=FALSE}
private_MFL = filter(malawi_facilities_MFL, OWNERSHIP == "Private")
# 433 private facilities, 30.3%

# which types are private?
private_MFL$TYPE = as.factor(private_MFL$TYPE)
types_private_MFL = as.data.frame(table(private_MFL$TYPE))
types_private_MFL
```
  
##### Hypothesis 3  

Within healthsites.io, 157 hospitals are recorded which is greater than both the MFL and WHO-KWTRP, with 117 and 82 hospitals respectively (figure 4). Healthsites.io does not provide a breakdown of hospitals into groups. A look into the distribution by district shows majority of the difference in hospital number is concentrated around 3 districts in the south (figure 5). Blantyre district has 39 hospitals in healthsites.io compared to 14 in the MFL and both its neighbouring Mwanza and Thyolo districts have 9 and 7 additional hospitals in healthsites.io respectively. Instances where the MFL has more hospitals in a district, the number does not exceed more than 4 facilities. A note here is that 4 hospitals in the MFL did not have accurate coordinates and so were dropped from the total of 117 in this analysis. 
  
```{r Hospital comparison, echo=FALSE, message=FALSE, warning=FALSE}
# barplot
Hospitals = c(117, 82, 157)
Source2 = c("MFL", "WHO-KWTRP", "healthsites.io")

hosp_3sources = data.frame(Hospitals, Source2)

plot_hosp_3sources = ggplot(hosp_3sources, aes(x=Source2, y=Hospitals)) + geom_bar(stat = "identity", width = 0.7, fill="slategray") + labs(x = "Source of data", y = "Number of hospitals") + theme_minimal() + expand_limits(y=c(0,200)) + coord_flip()
plot_hosp_3sources

# plot of hospitals in healthsites.io
hosp_rhs = filter(malawi_rhs, amenity == "hospital")

tmap_facilities_rhs = tmap_admin2 + tm_shape(hosp_rhs) + tm_dots(col = "mediumseagreen") + tm_layout(frame = FALSE, asp = 2, title = "healthsites.io", title.position = c("left", "top"))

facilities_rhs = tmap_arrange(tmap_facilities_MFL, tmap_facilities_rhs, ncol = 2)

# districts
all_hosp_MFL = filter(malawi_facilities_MFL, TYPE == "Central Hospital" | TYPE == "District Hospital" | TYPE == "Hospital")

malawi_admin2$hosp_rhs = lengths(st_intersects(malawi_admin2, hosp_rhs, sparse = TRUE))
malawi_admin2$all_hosp_MFL = lengths(st_intersects(malawi_admin2, all_hosp_MFL, sparse = TRUE))
# 4 hospitals did not intersect


# plot

tmap_hosp_MFL = tm_shape(malawi_admin2) + tm_borders() + tm_shape(malawi_admin2) + tm_fill("all_hosp_MFL",  palette = sequential_hcl(6, palette = "YlGnBu", rev = TRUE), title = "Hospitals", breaks = c(0, 5, 10, 15, 20)) + tm_layout(title = "MFL")

tmap_hosp_rhs = tm_shape(malawi_admin2) + tm_borders() + tm_shape(malawi_admin2) + tm_fill("hosp_rhs",  palette = sequential_hcl(6, palette = "YlGnBu", rev = TRUE), title = "Hospitals", breaks = c(0, 5, 10, 15, 20, 25, 30, 35, 40)) + tm_layout(title = "healthsites.io")

hosp_MFL_rhs = tmap_arrange(tmap_hosp_MFL, tmap_hosp_rhs, ncol = 2)
hosp_MFL_rhs
```  
  
##### Data quality  

As mentioned previously, the MFL contains some missing coordinates. Upon inspection, there are 181 missing values, which also contains 62 coordinates that are not in Malawi and were either inputted incorrectly or not known. The missing values were omitted before analysis. However, if these 62 coordinates are also removed, there are 1365 facilities in the MFL. In the WHO-KWTRP, there are 9 missing coordinates and this was stated in (Maina et al., 2019). Healthsites.io carries some missing attributes but all coordinates are present and reside within Malawi. The WHO-KWTRP contains the least attribute data, only describing ownership and admin 1 regions the facilities are in besides the core information of name, type and location. The MFL adds to this by including admin 2 regions, which are the districts, functionality, date opened and another version for facility names under the column 'Common name'. However, their website for the MFL gives the option of obtaining more information on capacity and resources by selecting an individual facility. Unfortunately this aspect is not available as part of the MFL data to download. Healthsites.io by far provides a greater variety of attributes out of the 3 sources. However for Malawi, 13.7% of facilities have no names assigned, which is one of the basic elements needed. Other attributes are sparse.  

```{r NAs in data, include=FALSE}
# MFL - 1546 before omitting NA's, then 1427.
# 62 coordinates did not intersect with admin data - now 1365

# using anti_join() to see which facilities were omitted 
df_malawi_facilities_MFL = as.data.frame(malawi_facilities_MFL) # convert to data frame to use in anti_join

NA_MFL = anti_join(malawi_MFL, df_malawi_facilities_MFL) # 119 missing coordinates in MFL

# adding the number of wrong coordinates - 61
intersect_admin1_MFL = st_intersection(malawi_facilities_MFL, malawi_admin1) # returns data frame of matches

intersect_admin1_MFL = as.data.frame(intersect_admin1_MFL) # convert to data frame to use in anti_join

no_intersect_admin1_MFL = anti_join(malawi_facilities_MFL, intersect_admin1_MFL) # working out which facilities did not intersect

no_intersect_admin1_MFL_1 = no_intersect_admin1_MFL[ ,-c(10, 11)]
NA_MFL_1 = NA_MFL[, -c(10, 11)]
no_intersect_admin1_MFL_1 = st_set_geometry(no_intersect_admin1_MFL_1, NULL)
names(NA_MFL_1)[3] = "COMMON.NAME"
names(NA_MFL_1)[9] = "DATE.OPENED"

NA_MFL = rbind(NA_MFL_1, no_intersect_admin1_MFL_1) # combined dataframe of NA and wrong coordinates in MFL

# WHO - 648 with 9 missing coordinates, now 639
NA_WHO = anti_join(malawi_WHO, new_malawi_WHO)

```
  
Analysis into duplicates within lists shows that names for 5 facilities in the MFL appear more than once and also have identical coordinates up to at least 2 decimal places. Of these 5 facilities, 3 share same entries in the other attribute columns while the remaining 2 differ in type. In the WHO-KWTRP, one health centre appears twice with the same attributes and coordinates. With healthsites.io, there are 17 names that appeared more than once and all apart from 2 have similar coordinates up to at least 2 decimal places. Searching for duplicate coordinates rather than names also gave matches. In healthsites.io, 4 facilities that were also part of the previous 17 have identical coordinates. The timestamp on these facilities indicate that their duplicates were inputted at the exact same time. The WHO-KWTRP list does not have duplicates while the MFL returned 44 distinct coordinates that were repeated at least more than once. One of these cases is repetition of one location for 24 facilities, of different types and names, in Blantyre. However, some results are due to no coordinates being available and for example, (-1,1) was inputted instead.  

```{r Duplicates, include=FALSE}
# MFL
duplicate_name_MFL = malawi_facilities_MFL[malawi_facilities_MFL$NAME %in% malawi_facilities_MFL$NAME[duplicated(malawi_facilities_MFL$NAME)], ]

# WHO 
duplicate_name_WHO = new_malawi_WHO[new_malawi_WHO$`Facility name` %in% new_malawi_WHO$`Facility name`[duplicated(new_malawi_WHO$`Facility name`)], ]

# healthsites
duplicate_name_rhs = malawi_rhs[malawi_rhs$name %in% malawi_rhs$name[duplicated(malawi_rhs$name)], ]
malawi_rhs$name[duplicated(malawi_rhs$name)]

# Misuku (time is different, 5 decimal places), AREA18 (time is same, 5 decimal), Leo pharm (mostly diff, 3 decimal), Care (identical), Likuni (same, 5 decimal), Nakalanzi (different, 2 dec), Kamuzu (2 same user, all diff coord), pharmcare (identical), one stop (diff coord), mwalingo (diff, 3 dec), nsambe (same, 4 dec), good hope (identical), nakalanzi (diff, 2 dec), health (same, 1 dec), chanc (diff, 4 dec), lifuwu (diff, 3 dec), nkombezi (same, 3 dec).

# Same coordinates within dataset

## MFL 
duplicate_coord_MFL = malawi_facilities_MFL[malawi_facilities_MFL$geometry %in% malawi_facilities_MFL$geometry[duplicated(malawi_facilities_MFL$geometry)], ]

## WHO 
sf_malawi_WHO$geometry[duplicated(sf_malawi_WHO$geometry)] # none

## healthsites 
duplicate_coord_rhs = malawi_rhs[malawi_rhs$geometry %in% malawi_rhs$geometry[duplicated(malawi_rhs$geometry)], ]
malawi_rhs$geometry[duplicated(malawi_rhs$geometry)]

```






















